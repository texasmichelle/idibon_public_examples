#!/usr/bin/python
# -*- coding: utf-8 -*-

import httplib
import json

def main():
  # Establishes an HTTP connection with the local Idibon Public server
  connection = httplib.HTTPConnection("localhost:8080")

  taskClassContent = createTaskContentDict()
  for taskClass, content in sorted(taskClassContent.iteritems()):
    taskClassArray = taskClass.split(";")
    task = taskClassArray[0]
    descriptor = taskClassArray[1]
    expected_classification = taskClassArray[2]

    body = json.dumps({"content": content})

    # Sends a GET request to the server for the English Social Sentiment model
    connection.request("GET", "/NewsWire_Relevance/" + task, body)
    response = connection.getresponse()
    res = response.read()

    # Formats the prediction from the Idibon Public server to print
    json_res = json.loads(res[1:-1])

    # Ensure the classification matches
    returned_classification = json_res["class"]
    #confidence = str(json_res["confidence"])
    confidence = '%.2f' % json_res["confidence"]
    if (returned_classification != expected_classification):
      print "ERROR " + task + " " + expected_classification + " " + descriptor + " does not match: " + returned_classification + " " + confidence
      print json.dumps(json_res, sort_keys = True, indent = 4, separators = (',', ': '))
#    else :
#      print task + " " + expected_classification + " " + descriptor + " matches with " + confidence + " confidence"
  

  # Closes the HTTP connection
  connection.close()

  return

def createTaskContentDict():
  taskContent = {}

  taskContent["Agriculture;;Irrelevant"] = """  &#13;\n &#13;\nBy Emily Clarkeclark@wickedlocal. com&#13;\n &#13;\n&#13;\n &#13;\n  Wicked Local Kingston  &#13;\n   &#13;\nBy Emily Clark  eclark@wickedloca     l. com&#13;\n   &#13;\n &#13;\n &#13;\nPosted Aug&*& 5, 2015 at 10:00 AM&#13;\n &#13;\n
"""
# Content missing
#  taskContent["Agriculture;;Relevant"] = """

  taskContent["Automotive;;Irrelevant"] = """  &#13;\n CYBERPOWERPC Updates Gaming PC Lineup Launches New Luxe Series Gaming PCs CITY OF INDUSTRY, CA (August 5, 2015) – CyberPower Inc&*&,www. cyberpowerpc. com, a global manufacturer of custom gaming PCs,&;&.  \n &#13;\n&#13;\n&#13;\n Read the rest of this entry » Legit Reviews. &#13;\nTags: CyberPower, CyberPowerPC, Intel Core i7-6700K, legitreviews-com, Press Releases &#13;\n&#13;\n&#13;\n&#13;\n&#13;\n&#13;\n&#13;\n  
"""
  taskContent["Automotive;;Relevant"] = """"   According to a Wall Street Journal report, the 600-member team has been approved to triple its ranks in order to hit a target ship date of 2019. The newspaper also reports that an Apple team met with two different groups of California government officials. \n Apple has internally designated an electric vehicle  as a “committed project”, the newspaper reported, citing people familiar with the matter. \n Despite Apple’s interest in driverless cars, it appears the first-generation vehicle will not be fully self-driving, reports WSJ. This project has been tipped by anonymous insiders, otherwise known as “people familiar with the matter” speaking with the Wall Street Journal this morning. \n Apple had spent a year reviewing the feasibility of an effort, writes Wakabayashi. \n Apple joins Google in this new race to get an electric vehicle  on to roads. However, Tesla has demonstrated that it’s time for big changes in the automotive industry, and Apple could have taken notice. \n “We believe the auto industry represents a significant opportunity for Apple, but we also expect Apple to be deliberate as always in its product development and testing”, said Piper Jaffray analyst Gene Munster in a September  1 report. When there were rumors of Apple trying a phone, a lot of us had trouble understanding why. While Elon Musk’s company does not sell a completely autonomous driving vehicle , Tesla’s Model S is smart enough to safely navigate between lanes, sense pedestrians, adhere to speed limit signs and even pull into a spot in a parking garage. \n Many details remain unclear, including who will actually build the cars for Apple. And we know they’re interested in doing vehicle testing at a former Navy weapons station east of San Francisco. \n  ", "lead" : "According to a Wall Street Journal report, the 600-member team has been approved to triple its ranks in order to hit a target ship date of 2019. The newspaper also reports that an Apple team met with two different groups of California government officials. Apple has internally designated an electric vehicle  as a “committed project”, the newspaper reported, citing people familiar with the matter. Despite Apple’s interest in driverless cars, it appears the first-generation vehicle will not be fully self-driving, reports WSJ.
"""

# Consumerpackagedgoods uses pharmaceutical task??
  taskContent["Pharmaceuticals;consumerPackageGoods;Irrelevant"] = """ \n Archer Daniels Midland Company yesterday reported financial results for the quarter ended Mar&*& 31, 2016.  The company reported adjusted earnings per share1 of $0&@&42, down from $0&@&78 in the same period last year. Included in these results was a $0&@&08 per share loss related to updated portfolio valuations in an investment joint venture. Adjusted segment operating profit1 was $573 million, down 36 percent from $892 million in the year-ago period. Net earnings for the quarter were $230 million, or $0&@&39 per share. \n “Challenging market conditions continued in the first quarter, particularly affecting Ag Services,” said ADM Chairman and CEO Juan Luciano. “Low U&-&S&-& export volumes and weak margins continued, and in the quarter, poor results from the global trade desk impacted results for Ag Services. Results for Corn improved compared to the first quarter one year ago, led by a strong performance in sweeteners and starches. For Oilseeds, global protein demand remained solid. However, first quarter results were impacted by weak global crush margins. \n However, Luciano also said that despite the challenges, ADM continued to advance their strategic plan.   Advancements included acquiring a controlling stake in Harvest Innovations as a way to enhance their gluten-free ingredient business as well as the purchase of a wet corn mill in Morroco and the opening of a flavor creation laboratory in New Jersey.   Additionally, Luciano emphasized as part of their portfolio management strategy they have also reached an agreement to sell their Brazilian sugarcane ethanol holdings. \n In a statement that should be encouraging to farmers, Luciano also said that while the first half of the year has had it’s challenges, ADM is cautiously optimistic that reduced South American corn and soybean production will bring about improved crush and merchandising options. \n According to the press release, the following items had the most impact on first quarter results: \n• Adjusted earnings per share of $0&@&42 excludes a $0&@&02 per share charge related to last in first out accounting and $0&@&01 per share in impairments. Included in adjusted earnings per share is a $0&@&08 per share loss related to updated portfolio investment valuations in CIP, an investment joint venture.\n• Agricultural Services decreased $118 million compared to a strong quarter last year amid lower North American export volumes and margins, fewer global merchandising and transportation opportunities, as well as unfavorable Global Trade Desk merchandising positions.\n• Corn Processing increased $2 million as strong results for sweeteners and starches were offset by weaker lysine results and lower ethanol margins.\n• Oilseeds Processing decreased $231 million compared to a very strong year-ago period, as higher Argentine crush run rates weakened global margins.\n While the low prices have affected farmers, ADM’s results indicate that they aren’t in a much different position.    Agricultural Services operating profit was $76 million, down $118 million from the year-ago quarter.   Merchandising and handling earnings declined $83 million to $24 million, primarily due to a challenging merchandising environment that continued due to weak U&-&S&-& export competitiveness, lower North American volumes and margins, and a quarterly loss for the global trade desk compared to positive results last year. Losses from the global trade desk were caused in part by unfavorable merchandising positions. \n That last issue will prove to be an ongoing challenge for Luciano.   One of his stated goals upon becoming CEO was to smooth out some of the volatility in results stemming from the trading desk which may prove challenge according to experts as volatility in the market picks up. \n  \n \nShare\n  
"""
  taskContent["Pharmaceuticals;consumerPackageGoods;Relevant"] = """ \n J. Erik Fyrwald has been appointed Chief Executive Officer of Syngenta. \n Fyrwald is the current President and CEO of Univar.  He will succeed John Ramsay, who has been acting as interim CEO since November of 2015. \n “After a rigorous search, the Board concluded that Erik’s leadership and considerable experience in both agriculture and chemicals, along with his strong track record of success as a CEO made him the outstanding candidate for the role, said Michel Demare, Syngenta’s Chairman.  “Erik has demonstrated throughout his career the ability to work successfully in different environments, designing and leading strategies which resulted in impressive value creation. I look forward to working with him to create the next chapter of Syngenta’s story of success&=&. \n Ramsay, who has served as Chief Financial Officer of Syngenta for nine years, will be working closely with Fyrwald to create a smooth transition.  Closing the ChemChina transaction is high on the priority list during this time. \n Mr&*& Fyrwald spent 27 years at DuPont where he held positions in technology, manufacturing, sales and marketing, strategic planning and regional and global business unit leadership, including four years in Asia. In 2003, Mr&*& Fyrwald was named Group Vice President of DuPont Agriculture and Nutrition. Mr&*& Fyrwald also served as Chairman of Crop Life International for two years during this period. \n  In 2008, Mr&*& Fyrwald was named Chairman, President and CEO of Nalco. In December 2011, Nalco was acquired by EcoLab&*& Mr&*& Fyrwald was President of EcoLab until May 2012, when he was appointed CEO of Univar, a leading global distributor of chemical products and provider of related services, including agricultural inputs. \n  Mr&*& Fyrwald serves on the boards of Eli Lilly and Company (including their Science and Technology Committee) and the Society of Chemical Industry. He holds a bachelor’s degree in chemical engineering from the University of Delaware and completed the Advanced Management Program at Harvard Business School. \n “I have admired Syngenta from the outside for many years and am delighted, therefore, to have been chosen to lead the company in the next exciting phase of its journey,” Frywald says.   “I greatly look forward to meeting employees, leaders, customers and other stakeholders after I join in June and to working with them to achieve further success in the years to come&=&. \n  
"""

# Content missing
#  taskContent["EEC;;Irrelevant"] = """
#  taskContent["EEC;;Relevant"] = """

  taskContent["Events;;Irrelevant"] = """ &#13;\n &#13;\nDetroit: Dry Weather to Linger Through Start of Weekend &#13;\n &#13;\n &#13;\n &#13;\nBy Eric Drewitz, AccuWeather. com Meteorologist &#13;\nAugust 5, 2015; 8:06 AM ET &#13;\n &#13;\n&#13;\n&#13;\n &#13;\n&#13;\n&#13;\n The dry weather that has occurred throughout the greater Detroit area the past few days will continue to linger for the next several days. \n The current dry pattern will hold until an upper-level disturbance will bring thunderstorms to the area on Sunday. Temperatures will continue to be seasonably warm with low humidity levels for the start of August. \n Detroit has received about 108 percent their normal rainfall since June 1. \n A storm system will be passing south of the region into the mid-Atlantic states with Detroit remaining primarily dry through Friday morning. A disturbance bringing thunderstorms to the Chicago area on Friday should fizzle out before reaching Detroit. \n RELATED: Detailed Forecast for DetroitInteractive RadarAccuWeather MinuteCast® for Detroit \n The weather will be a hit for the fans at Tiger Stadium Wednesday evening. Other favored activities include biking, hiking and swimming. \n&#13;\n&#13;\n&#13;\n  
"""
  taskContent["Events;;Relevant"] = """ &#13;\n &#13;\nHarrisburg: Dry Weather Will Linger for Next Several Days &#13;\n &#13;\n &#13;\n &#13;\nBy Eric Drewitz, AccuWeather. com Meteorologist &#13;\nAugust 5, 2015; 9:52 AM ET &#13;\n &#13;\n&#13;\n&#13;\n &#13;\n&#13;\n&#13;\n Dry weather is in store for the greater Harrisburg area for the upcoming weekend. \n The dry weather that kicked off the month of August will linger for the next several days. Temperatures will remain seasonable with low humidity values for the beginning of August. \n Pennsylvania's capital has received about 162 percent of their normal rainfall since June 1, a large surplus of rainfall this summer. Surrounding areas such as York, Pennsylvania, received even more of a surplus with a whopping 175 percent of their normal rainfall in this time. \n The dry weather is expected to be beneficial for gardeners and farmers alike. \n RELATED: Detailed Harrisburg ForecastHarrisburg Interactive Weather RadarAccuWeather MinuteCast® for Harrisburg \n Activities that are promoted by this current weather pattern are camping, biking and hiking. \n&#13;\n&#13;\n&#13;\n  
"""

  taskContent["Miscellaneous;heavy industries;Irrelevant"] = """ \nFriday, February 26, 2016 11:29 a&-&m&-& EST\n  \n (Reuters) - Caterpillar Inc  and Deere &amp; Co  said on Friday they are cutting a total of 170 jobs in their factories in yet another step in the consolidation of the slumping U&-&S&-& heavy machinery sector.  \n Deere, a leading maker of farm and construction equipment, said 100 employees will be placed on indefinite layoff effective April 1 in two of the company's factories in Iowa that make construction and forestry machinery.   \n Caterpillar, the world's largest maker of construction and mining equipment, said it will halt production of its on-highway trucks at its plant in Texas, eliminating 70 jobs.  \n Both companies have faced declining sales as global construction activity slows. \n Deere shares were up about 0&@&5 percent at $79&@&98 and Caterpillar shares were 1&@&6 percent higher at $67&@&53 in early trading.  \n  (Reporting By Meredith Davis; Editing by Steve Orlofsky) \n  
"""
  taskContent["Miscellaneous;heavy industries;Relevant"] = """ \nResearch and Markets: Global Discrete Semiconductors Market 2015-2019 - Automotive, ICT, Industrial (Manufacturing) and Consumer Electronics\n World News: 19:35 GMT Monday 14th December 2015. [Research and Markets via Businesswire via SPi World News] \n       Research and Markets (http://www. researchandmarkets. com/research/fx4hh7/global_discrete)       has announced the addition of the \"Global       Discrete Semiconductors Market 2015-2019\" report to their       offering.                The global discrete semiconductors market to grow at a CAGR of 4&@&61% in       terms of revenue over the period 2014-2019.                Until 2014, the market generated the majority of its revenue from APAC       owing to the growing number of players and increased demand for discrete       semiconductors within this region. Countries such as Japan, China,       Taiwan, and South Korea were the key contributors in APAC. APAC was       followed by EMEA and the Americas.                With technological advances and market maturation, certain emerging       trends such as high-powered electronic devices will shape the future of       the global discrete semiconductors market. Energy efficiency is one of       the key issues facing the market and discrete semiconductor devices can       offer a solution to this problem. Thus, with consistent improvement in       technology and efficiency, these devices are expected to fulfill the       increasing demand.                According to the report, increasing demand for hybrid and electric       vehicles is the main driver of the global discrete semiconductors       market. Demand and production of electric vehicles has seen an       exponential rise since 2010, and is likely to follow the same trend       during the forecast period due to depleting fossil fuel reserves.                Further, the report states that one key challenge to the growth of this       market is the high cost of discrete power semiconductors, which generate       most of the market revenue.                This report covers the current scenario and the growth prospects of the       global discrete semiconductors market during 2015-2019. To calculate the       market size, the report considers revenue generated through the sales of       discrete semiconductor devices worldwide.                Key vendors                        Fairchild Semiconductor                    Infineon Technologies                    NXP Semiconductor                    ON Semiconductor                    ROHM Semiconductor                    STMicroelectronics                    Toshiba                    Vishay                      Other prominent vendors                        ABB                    Cree                    Freescale Semiconductor                    Microsemi                    Mitsubishi Electric                    Renesas Electronics                    Rockwell Automation                    Taiwan Semiconductors Manufacturing (TSMC)                    Texas Instruments                      Key Topics Covered:                Part 01: Executive summary                Part 02: Scope of the report                Part 03: Market research methodology                Part 04: Introduction                Part 05: Market landscape                Part 06: Technology landscape                Part 07: Market segmentation by application                Part 08: Geographical segmentation                Part 09: Market drivers                Part 10: Impact of drivers                Part 11: Market challenges                Part 12: Impact of drivers and challenges                Part 13: Market trends                Part 14: Vendor landscape                Part 15: Key vendor analysis                Part 16: Appendix                For more information visit http://www. researchandmarkets. com/research/fx4hh7/global_discrete            View source version on businesswire. com: http://www. businesswire. com/news/home/20151214006233/en/  More news and information about Research and Markets  Published By:  Business Wire: 19:35 GMT Monday 14th December 2015  Published: 2015-12-14T19:35:00.  \n Search for other references to \"research\" on SPi News     
"""

# Content missing
#  taskContent["Pharmaceuticals;;Irrelevant"] = """
  taskContent["Pharmaceuticals;;Relevant"] = """ \n Naturex has announced a 28% increase in its first half revenues to €202&@&6m, with gross margin 14&@&5% ahead. Net income attributable to the group was, however, off 61&@&3% to €2&@&9 million. \n The company said that it implemented its plan in 2H15 to regain commercial momentum by applying a targeted customer approach and a stronger offering of products and innovative concepts within strategic market categories. This, it said, contributed to a return to organic growth (+4&@&5%) with sales stabilising for the historical group structure by the 2015 first quarter, after four consecutive quarters of decline and followed by a strong acceleration in the second quarter (+9&@&0%) \n The Group also benefited from a particularly favourable currency effect resulting from the strong contribution of US dollar sales. \n Naturex noted that it had taken a number of exceptional actions and incurred exceptional costs during the half year in support of its realignment, including significant de-stocking, and these had meant that the improved gross margin had not dropped through to the bottom line. \n “Operational and financial discipline measures taken over the first six months through the Conquest, Cash &amp; People plan represent a first step in our Group’s transition to a model for sustainable, lasting and profitable growth over the medium-term. As previously indicated, our priority in the second half will be improving operating profitability. By pursuing solid and dynamic growth, we will be able to activate the operational drivers necessary for achieving this objective,” said Olivier Rigaud, Chief Executive Officer and Director of Naturex. \n “In terms of governance, after reinforcing the Management Committee in the first half by the addition of the Human Resources Director and the Chief Legal Officer, our Senior Management team will be completed in early November by the arrival of a new Chief Financial Officer&=&. \n   \n  
"""


  taskContent["Transportation;;Irrelevant"] = """  \n Stocks hit 2016 highs on Wednesday, and Thursday’s session is looking for direction, with futures fighting over being slightly positive and slightly down. It seems that investors have decided to revert back to the trend of the prior four years of buying pullbacks. \n 24/7 Wall St&*& reviews dozens of analyst research reports each morning of the week to find new investing and trading ideas for our readers. Some of these analyst reports cover stocks to buy, while others cover stocks to sell or avoid. \t\t\t&#13;\n These are the top analyst upgrades, downgrades and initiations seen on Thursday morning: \n 3D Systems Corp. (NYSE: DDD) was raised to Buy at Bank of America Merrill Lynch, all the way up from Underperform. The firm raised its price objective by over 100% — to $26 from $11 — noting that the CEO announcement was a much needed catalyst to drive 3D’s turnaround through new strategy, alignment of cost structure and portfolio optimization. 3D Systems has a consensus analyst price target of $12&@&27 and a 52-week trading range of $6&@&00 to $32&@&88. \n Apple Inc&*& (NASDAQ: AAPL) was maintained as Buy with a $120 price target at UBS, but the firm noted many existential threats, like Facebook’s messenger bots, smartphone upgrade fatigue and migration/churn, and roadblocks for new phones in China.  Apple has a consensus price target of $133&@&92 and a 52-week range of $92&@&00 to $134&@&54.\n \nApplied Materials Inc&*& (NASDAQ: AMAT) was raised to Buy from Neutral with a price target of $26 (versus a $21&@&31 prior close) at UBS. The consensus price target is $22&@&55, and the 52-week range is $14&@&25 to $22&@&67.\n Chipotle Mexican Grill Inc&*& (NYSE: CMG) was raised to Overweight from Neutral with a $510 price target (versus a $444&@&66 close) at JPMorgan. The consensus analyst price target is $477, and the 52-week range is $399&@&14 to $758&@&61. \n CSX Corp. (NYSE: CSX) was reiterated as Buy and the target price was raised to $30 from $28 (versus a $26&@&03 close) at Argus. The firm said that CSX management is focused on shareholder returns by increasing the dividend and buying back stock, and the current 2&@&9% dividend yield pays investors to wait. CSX has a $27&@&26 consensus price target, and its 52-week range is $21&@&33 to $37&@&67. \n PepsiCo Inc&*& (NYSE: PEP) was downgraded to Hold from Buy at Stifel. Shares closed most recently at $104&@&12. The beverage and snack-foods maker has a consensus price target of $107&@&62 and a 52-week range of $76&@&48 to $105&@&77. \n Red Hat Inc&*& (NYSE: RHT) was raised to Overweight from Sector Weight with a price target of $88 (versus a $74&@&05 close) at Pacific Crest. It has a consensus price target of $88&@&17 and a 52- week range of $59&@&59 to $84&@&44. \n You can follow @Jonogg to get the daily analyst calls and market reports directly on your Twitter feed. \n Other key analyst upgrades and downgrades were seen on Thursday in the following: \n  
"""
# Content missing
#  taskContent["Transportation;;Relevant"] = """

  return taskContent

main()

